---
title: "Google Tag Manager"
sidebarTitle: GTM (Analytics)
"og:title": "How to track sales conversion events with Google Tag Manager and Dub"
description: "Learn how to track sales conversion events with Google Tag Manager and Dub"
og:image: https://assets.dub.co/cms/gtm-integration.jpeg
---

import EnableConversionTracking from "/snippets/enable-conversion-tracking.mdx";
import SalesAttributes from "/snippets/sale-attributes.mdx";
import ViewConversions from "/snippets/view-conversions.mdx";

<Note>
  Conversion tracking requires a [Business plan](https://dub.co/pricing)
  subscription or higher.
</Note>

When it comes to [conversion tracking](/conversions/quickstart), a `sale` event happens when a user purchases your product or service. Examples include:

- Subscribing to a paid plan
- Usage expansion (upgrading from one plan to another)

In this guide, we will be focusing on tracking sales events for a SaaS application that uses Google Tag Manager to manage client-side tracking scripts.

## Prerequisites

<EnableConversionTracking />

## Set up Dub Analytics in Google Tag Manager

<Tip>
  If you've already set up the [Dub Analytics script for lead
  tracking](/conversions/leads/google-tag-manager), you can skip to Step 2.
</Tip>

To track sales conversion events with Google Tag Manager, you'll need to install the Dub analytics script and configure sales tracking tags.

### Step 1: Add Dub Analytics Script to GTM

<Tip>
  If you've already set up the [Dub Analytics script for lead
  tracking](/conversions/leads/google-tag-manager), you can skip this step.
</Tip>

First, you'll need to add the Dub analytics script to your website using Google Tag Manager.

In your GTM workspace, navigate to the **Tags** section and click **New** to create a new tag.

<Frame>
  <img
    src="/images/conversions/google-tag-manager/gtm-new-tag.png"
    alt="GTM New Tag"
    width="1440"
    height="1024"
  />
</Frame>

Select **Custom HTML** as the tag type and add the following code:

```html
<script>
  !(function (c, n) {
    c[n] =
      c[n] ||
      function () {
        (c[n].q = c[n].q || []).push(arguments);
      };
    ["trackClick", "trackLead", "trackSale"].forEach(
      (t) => (c[n][t] = (...a) => c[n](t, ...a))
    );
    var s = document.createElement("script");
    s.defer = 1;
    s.src = "https://dubcdn.com/analytics/script.conversion-tracking.js";
    s.setAttribute("data-publishable-key", "dub_pk_xxxxxxxx"); // Replace with your publishable key
    document.head.appendChild(s);
  })(window, "dubAnalytics");
</script>
```

<Warning>
  Make sure to replace `dub_pk_xxxxxxxx` with your actual [publishable
  key](https://dub.co/docs/api-reference/publishable-keys) from your Dub
  workspace (under the [Analytics settings
  page](https://app.dub.co/settings/analytics)).
</Warning>

Configure the tag to fire on **All Pages** by setting the trigger to **All Pages - Page View**.

Name this tag "Dub Analytics Script" and save it.

### Step 2: Create Sales Tracking Tag for Checkout Forms

Next, create a tag to track sales when users complete checkout forms on your website.

Create another **Custom HTML** tag with the following code:

```html
<script>
  (function () {
    // Get checkout data - customize these selectors based on your form
    var customerId = document.getElementById("customer_id")
      ? document.getElementById("customer_id").value
      : "";
    var amount = document.getElementById("amount")
      ? document.getElementById("amount").value
      : "";
    var invoiceId = document.getElementById("invoice_id")
      ? document.getElementById("invoice_id").value
      : "";

    // Only track if customer ID and amount are present
    if (customerId && amount) {
      // Track the sale event
      dubAnalytics.trackSale({
        eventName: "Purchase",
        customerExternalId: customerId,
        amount: parseInt(amount), // Amount in cents
        invoiceId: invoiceId || undefined,
        currency: "usd", // Customize as needed
        paymentProcessor: "stripe", // Customize as needed
      });
    }
  })();
</script>
```

<Note>
  **Important**: You'll need to customize the DOM selectors
  (`getElementById('customer_id')`, `getElementById('amount')`, etc.) to match
  your actual checkout form field IDs or use different methods to capture the
  form data based on your website's structure.
</Note>

Configure this tag to fire on **Form Submission** by creating a new trigger:

- Trigger Type: **Form Submission**
- This trigger fires on: **Some Forms** (or **All Forms** if you want to track all form submissions)
- Add conditions to specify which forms should trigger sales tracking (e.g., checkout forms)

Name this tag "Dub Sales Tracking - Checkout Form" and save it.

### Step 3: Create Sales Tracking Tag for Order Confirmation Pages

For tracking sales on order confirmation pages (recommended approach), create another **Custom HTML** tag:

```html
<script>
  (function () {
    // Get query parameters from URL
    var params = new URLSearchParams(window.location.search);
    var customerId = params.get("customer_id");
    var amount = params.get("amount");
    var invoiceId = params.get("invoice_id");

    // Only track if customer ID and amount are present
    if (customerId && amount) {
      // Track the sale event
      dubAnalytics.trackSale({
        eventName: "Purchase",
        customerExternalId: customerId,
        amount: parseInt(amount), // Amount in cents
        invoiceId: invoiceId || undefined,
        currency: "usd", // Customize as needed
        paymentProcessor: "stripe", // Customize as needed
      });
    }
  })();
</script>
```

Configure this tag to fire on specific pages by creating a **Page View** trigger with conditions:

- Trigger Type: **Page View**
- This trigger fires on: **Some Page Views**
- Add conditions like:
  - **Page URL** contains `/order-confirmation`
  - Or **Page Path** equals `/checkout/success`
  - Or whatever URL pattern matches your order confirmation pages

Name this tag "Dub Sales Tracking - Order Confirmation" and save it.

<SalesAttributes />

## Testing your setup

To test your GTM setup, you can use the **Preview** mode in Google Tag Manager:

1. **Enable Preview Mode**: In your GTM workspace, click the **Preview** button in the top right corner
2. **Enter your website URL** and click **Connect**
3. **Navigate to a checkout page** or your order confirmation page
4. **Complete a test purchase** or visit the confirmation page with query parameters
5. **Check the GTM debugger** to see if your tags are firing correctly

### Verify sales tracking

You can also verify that sales are being tracked by:

1. **Checking your browser's developer console** for any JavaScript errors
2. **Using the Network tab** to see if requests are being sent to Dub's analytics endpoint
3. **Viewing your Dub dashboard** to confirm that sale events are appearing in your analytics

### Common troubleshooting tips

- **Tag not firing**: Check that your triggers are configured correctly and that the conditions match your page structure
- **Form data not captured**: Verify that your DOM selectors match your actual form field IDs or names
- **Amount formatting**: Ensure amounts are in cents (e.g., $10.00 = 1000 cents)
- **Multiple events**: Make sure your tags aren't firing multiple times by checking trigger conditions
- **Missing publishable key**: Ensure you've replaced the placeholder with your actual publishable key

<Warning>
**Client-Side Tracking Limitations**:
- **Ad blockers** – Users with ad blockers may prevent tracking scripts from loading
- **JavaScript disabled** – Events won't be tracked if users have JavaScript disabled  
- **Network issues** – Failed network requests won't retry automatically
- **Privacy concerns** – Some users may block client-side tracking for privacy reasons

For more accurate conversion tracking, consider using [server-side conversion tracking](/conversions/sales/introduction)

</Warning>

## View conversion results

And that's it – you're all set! You can now sit back, relax, and watch your conversion revenue grow. We provide 3 different views to help you understand your conversions:

<ViewConversions />
