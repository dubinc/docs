---
title: Server-side tracking
sidebarTitle: Server-side tracking (recommended)
og:title: Server-side sale tracking with Dub
description: Learn how to track sales conversion events with Dub using server-side tracking
---

import SalesIntro from "/snippets/sales-intro.mdx";
import ConversionTrackingPrerequisites from "/snippets/conversion-tracking-prerequisites.mdx";
import SaleAttributes from "/snippets/sale-attributes.mdx";
import ViewConversions from "/snippets/view-conversions.mdx";

<SalesIntro />

In this guide, we will be focusing on tracking sales conversion events with Dub.

## Sale tracking methods

Dub supports two methods for tracking sale events:

1. **Traditional method**: Requires a preceding lead event (click → lead → sale)
2. **Direct sale tracking**: Track sales directly from clicks without a lead event (click → sale)

The direct sale tracking method is particularly useful for:
- One-time purchases where users don't sign up
- E-commerce scenarios without a traditional lead/signup flow
- Simplified conversion funnels

<ConversionTrackingPrerequisites />

## Step 1: Configure sale tracking

Next, depending on which payment processor you're using, you can leverage our native integrations to track sale events:

<CardGroup cols={1}>
  <Card
    title="Stripe"
    icon="stripe"
    href="/conversions/sales/stripe"
    horizontal
  >
    Tracking sale conversion events with Stripe and the Dub SDK
  </Card>
  <Card
    title="Shopify"
    icon="shopify"
    href="/conversions/sales/shopify"
    horizontal
  >
    Tracking sale conversion events with Shopify and the Dub SDK
  </Card>
</CardGroup>

If you're not using any of the providers listed above, you can also manually track sale events using our [native SDKs](/sdks/overview) within your backend code:

<CodeGroup>

```javascript Node.js
import { Dub } from "dub";

const dub = new Dub();

await dub.track.sale({
  customerExternalId: "cus_RBfbD57HDzPKpduI8elr5qHA",
  amount: 100,
  paymentProcessor: "stripe",
  eventName: "E-book purchase",
  invoiceId: "123456",
  currency: "usd",
});
```

```python Python
from dub import Dub
import os

dub = Dub(token=os.environ['DUB_API_KEY'])

dub.track.sale({
    'external_id': 'cus_RBfbD57HDzPKpduI8elr5qHA',
    'amount': 100,
    'payment_processor': 'stripe',
    'event_name': 'E-book purchase',
    'invoice_id': '123456',
    'currency': 'usd'
})
```

```go Go
package main

import (
    "context"
    dub "github.com/dubinc/dub-go"
)

d := dub.New(
    dub.WithSecurity(os.Getenv("DUB_API_KEY")),
)

_, err := d.Track.Sale(context.Background(), &operations.TrackSaleRequest{
    CustomerExternalId:       "cus_RBfbD57HDzPKpduI8elr5qHA",
    Amount:          100,
    PaymentProcessor: "stripe",
    EventName:       "E-book purchase",
    InvoiceId:       "123456",
    Currency:        "usd",
})
```

```ruby Ruby
require 'dub'

dub = ::OpenApiSDK::Dub.new
dub.config_security(
  ::OpenApiSDK::Shared::Security.new(
    token: ENV['DUB_API_KEY']
  )
)

req = ::OpenApiSDK::Operations::TrackSaleRequest.new(
  external_id: 'cus_RBfbD57HDzPKpduI8elr5qHA',
  amount: 100,
  payment_processor: 'stripe',
  event_name: 'E-book purchase',
  invoice_id: '123456',
  currency: 'usd'
)

dub.track.sale(req)
```

```php PHP
<?php

require 'vendor/autoload.php';

use Dub\Dub;
use Dub\Models\Operations;

$dub = Dub::builder()->setSecurity($_ENV["DUB_API_KEY"])->build();

$request = new Operations\TrackSaleRequest();
$request->customerExternalId = 'cus_RBfbD57HDzPKpduI8elr5qHA';
$request->amount = 100;
$request->paymentProcessor = 'stripe';
$request->eventName = 'E-book purchase';
$request->invoiceId = '123456';
$request->currency = 'usd';

$dub->track->sale($request);
```

</CodeGroup>

<SaleAttributes />

## Direct sale tracking (without lead events)

For scenarios where you want to track sales directly from clicks without requiring a preceding lead event, you can use the direct sale tracking method. This requires passing the `clickId` parameter along with customer information:

<CodeGroup>

```javascript Node.js
import { Dub } from "dub";

const dub = new Dub();

// Get the clickId from the dub_id cookie
const clickId = getCookie('dub_id'); // Your cookie reading logic

await dub.track.sale({
  clickId: clickId,
  customerExternalId: "cus_RBfbD57HDzPKpduI8elr5qHA",
  customerName: "John Doe",
  customerEmail: "john@example.com",
  customerAvatar: "https://example.com/avatar.jpg",
  amount: 100,
  paymentProcessor: "stripe",
  eventName: "E-book purchase",
  invoiceId: "123456",
  currency: "usd",
});
```

```python Python
from dub import Dub
import os

dub = Dub(token=os.environ['DUB_API_KEY'])

# Get the clickId from the dub_id cookie
click_id = get_cookie('dub_id')  # Your cookie reading logic

dub.track.sale({
    'click_id': click_id,
    'external_id': 'cus_RBfbD57HDzPKpduI8elr5qHA',
    'customer_name': 'John Doe',
    'customer_email': 'john@example.com',
    'customer_avatar': 'https://example.com/avatar.jpg',
    'amount': 100,
    'payment_processor': 'stripe',
    'event_name': 'E-book purchase',
    'invoice_id': '123456',
    'currency': 'usd'
})
```

</CodeGroup>

### Required parameters for direct sale tracking

When using direct sale tracking, you need to provide:

- `clickId`: The unique click identifier (available from the `dub_id` cookie)
- `customerExternalId`: Your unique identifier for the customer
- `customerName`: Customer's name (optional - a random name will be generated if not provided)
- `customerEmail`: Customer's email address (optional)
- `customerAvatar`: Customer's avatar URL (optional)

<Note>
  The `clickId` is automatically stored in the `dub_id` cookie when a user clicks on your Dub link. Make sure you have the [@dub/analytics client-side SDK](/sdks/client-side/introduction) installed to capture this value.
</Note>

## Step 2: View conversion results

And that's it – you're all set! You can now sit back, relax, and watch your conversion revenue grow. We provide 3 different views to help you understand your conversions:

<ViewConversions />

## Currency conversion support

For simplicity, Dub records all sales in the default currency of your Dub workspace. This means that if you pass a different currency, it will be automatically converted to USD for reporting consistency – using the latest foreign exchange rates.

```typescript TypScript
await dub.track.sale({
  customerExternalId: "cus_RBfbD57HDzPKpduI8elr5qHA",
  amount: 15480, // this will be converted from PLN to USD
  currency: "pln",
  paymentProcessor: "stripe",
  eventName: "Purchase",
});
```

<Note>
  The default currency for all Dub workspaces is currently set to `USD`. We will
  add the ability to customize that in the future.
</Note>
